Homework/Test Two
========================================================
### NAMES: Tyler Davis, Susannah Hogue, Eitan Lees
*This is entirely our own work except as noted at the end of the document.*
```{r comment = NA, echo = FALSE}
Sys.time()

url = "http://www1.appstate.edu/~arnholta/Data/"
```


```{r message=FALSE,echo=FALSE}
require(PASWR)
require(ggplot2)

```

###

For all exercises that ask you to perform exploratory data analysis (EDA), you should plot the data (histogram, normal-quantile plots), describe the shape of the distribution (bell shaped, symmetric, skewed, etc.), and provide summary statistics (mean, standard deviation). For bootstrapping questions, use $10^4$ bootstraps, always provide plots, and describe the shape, spread, and bias of the distribution.  Make sure the $x$-axes for all bootstrap distributions label what you are bootstrapping.  All data sets for this homework are stored as `*.csv` files at [http://www1.appstate.edu/~arnholta/Data/](http://www1.appstate.edu/~arnholta/Data/)

**Problem 1:** Consider a population that has a normal distribution with mean $\mu = 36$, standard deviation $\sigma = 8$.
  * The sampling distribution of $\bar{X}$ for samples of size 200 will have what distribution, mean, and standard error?

> ANSWER: The resulting sampling distrubtion will be normal with a mean of 36 and a standard error of `r 8/sqrt(200)`

  * Use `R` to draw a random sample of size 200 from this population and store the values in an object named `nrs.200`. Conduct EDA on your sample.

```{r}
nrs.200 <- rnorm(200,36,8)
p <- ggplot(as.data.frame(nrs.200),aes(x=nrs.200),color="red")
p + geom_histogram(aes(y = ..density..), fill = "blue")+ geom_density(color = "red", size = 1.5)
```

> ANSWER: The mean, $\bar{X}$, is `r mean(nrs.200)` and the standard deviation, $\sigma$, is `r sd(nrs.200)`.

  * Compute the bootstrap distribution for $\bar{X}$ using the values stored in `nrs.200` and note the bootstrap mean and standard error.

```{r}
N = 10^4
boot.mean <- numeric(N)
for(i in 1:N){
  boot.mean[i] <- mean(sample(nrs.200,length(nrs.200),replace=TRUE))
}
```

> ANSWER: The bootstrapped mean, $\bar{X}^*$, is `r mean(boot.mean)` and standard error, $\sigma^*$, is `r sd(boot.mean)`

  * Compare the bootstrap distribution to the theoretical sampling distribution of $\bar{X}$.

> ANSWER: The bootstrap distribution has a bias of `r mean(boot.mean)-mean(nrs.200)`.

  * Repeat for samples of size $n = 50$ and $n=10$.  Carefully describe your observations about the effects of sample size on the bootstrap distribution.
  

```{r cache=TRUE}

nrs.50 <- rnorm(50,36,8)
p <- ggplot(as.data.frame(nrs.50),aes(x=nrs.50),color="red")
p + geom_histogram(aes(y = ..density..), fill = "blue")+ geom_density(color = "red", size = 1.5)

N = 10^4
boot.mean.50 <- numeric(N)
for(i in 1:N){
  boot.mean.50[i] <- mean(sample(nrs.50,length(nrs.50),replace=TRUE))
}

nrs.10 <- rnorm(10,36,8)
p <- ggplot(as.data.frame(nrs.10),aes(x=nrs.10),color="red")
p + geom_histogram(aes(y = ..density..), fill = "blue")+ geom_density(color = "red", size = 1.5)

N = 10^4
boot.mean.10 <- numeric(N)
for(i in 1:N){
  boot.mean.10[i] <- mean(sample(nrs.10,length(nrs.10),replace=TRUE))
}
```


> ANSWER: For $n = 50$ the bootstrap mean, $\bar{X}^*$, is `r mean(boot.mean.50)`, the standard error, $\sigma^*$, is `r sd(boot.mean.50)` and bias is, `r mean(boot.mean.50)-mean(nrs.50)`. For $n = 10$ the bootstrap mean, $\bar{X}^*$, is `r mean(boot.mean.10)`, the standard error, $\sigma^*$, is `r sd(boot.mean.10)` and bias is, `r mean(boot.mean.10)-mean(nrs.10)`. As the sample size increases, $\bar{X}^*$ and $\sigma^*$ approach $\bar{X}$ and $\frac{\sigma}{\sqrt{n}}$ respectivly.

**Problem 2:** Investigate the bootstrap distribution of the median. Create random samples of size $n$  for various $n$ and bootstrap the median. Describe the bootstrap distribution. Change the sample sizes to 36 and 37; 200 and 201; 10,000 and 10,001. Note the similarities/dissimilarities, trends, and so on. Why does the parity of the sample size matter?  Modify the following code as needed to answer the questions. (Adjust the $x$ limits in the plots as needed.)

```{r comment = NA, cache = TRUE}
ne <- 14 # n even
no <- 15 # n odd
wwe <- rnorm(ne) # draw a random sample of size ne
wwo <- rnorm(no) # draw a random sample of size no
B <- 10^4  # If your computer is fast, use 10^5
even.boot <- numeric(B)
odd.boot <- numeric(B)
for (i in 1:B){
  x.even <- sample(wwe, ne, replace = TRUE)
  x.odd <- sample(wwo, no, replace = TRUE)
  even.boot[i] <- median(x.even)
  odd.boot[i] <- median(x.odd)
}
opar <- par(no.readonly = TRUE) # read current parameters
par(mfrow=c(2, 1)) # set figure layout
hist(even.boot, breaks = "Scott", xlim = c(-2, 2), main = "")
hist(odd.boot, breaks = "Scott", xlim = c(-2, 2), main = "")
par(opar)  # reset graphical parameters

P2.1 <- c(mean(even.boot),mean(odd.boot))
```


```{r comment = NA, cache = TRUE}
ne <- 36 # n even
no <- 37 # n odd
wwe <- rnorm(ne) # draw a random sample of size ne
wwo <- rnorm(no) # draw a random sample of size no
B <- 10^4  # If your computer is fast, use 10^5
even.boot <- numeric(B)
odd.boot <- numeric(B)
for (i in 1:B){
  x.even <- sample(wwe, ne, replace = TRUE)
  x.odd <- sample(wwo, no, replace = TRUE)
  even.boot[i] <- median(x.even)
  odd.boot[i] <- median(x.odd)
}
opar <- par(no.readonly = TRUE) # read current parameters
par(mfrow=c(2, 1)) # set figure layout
hist(even.boot, breaks = "Scott", xlim = c(-.1, .1), main = "")
hist(odd.boot, breaks = "Scott", xlim = c(-.1, .1), main = "")
par(opar)  # reset graphical parameters
P2.2 <- c(mean(even.boot),mean(odd.boot))
```


```{r comment = NA, cache = TRUE}
ne <- 200 # n even
no <- 201 # n odd
wwe <- rnorm(ne) # draw a random sample of size ne
wwo <- rnorm(no) # draw a random sample of size no
B <- 10^4  # If your computer is fast, use 10^5
even.boot <- numeric(B)
odd.boot <- numeric(B)
for (i in 1:B){
  x.even <- sample(wwe, ne, replace = TRUE)
  x.odd <- sample(wwo, no, replace = TRUE)
  even.boot[i] <- median(x.even)
  odd.boot[i] <- median(x.odd)
}
opar <- par(no.readonly = TRUE) # read current parameters
par(mfrow=c(2, 1)) # set figure layout
hist(even.boot, breaks = "Scott", xlim = c(-.1, .1), main = "")
hist(odd.boot, breaks = "Scott", xlim = c(-.1, .1), main = "")
par(opar)  # reset graphical parameters
P2.3 <- c(mean(even.boot),mean(odd.boot))
```


```{r comment = NA, cache = TRUE}
ne <- 10000 # n even
no <- 10001 # n odd
wwe <- rnorm(ne) # draw a random sample of size ne
wwo <- rnorm(no) # draw a random sample of size no
B <- 10^4  # If your computer is fast, use 10^5
even.boot <- numeric(B)
odd.boot <- numeric(B)
for (i in 1:B){
  x.even <- sample(wwe, ne, replace = TRUE)
  x.odd <- sample(wwo, no, replace = TRUE)
  even.boot[i] <- median(x.even)
  odd.boot[i] <- median(x.odd)
}
opar <- par(no.readonly = TRUE) # read current parameters
par(mfrow=c(2, 1)) # set figure layout
hist(even.boot, breaks = "Scott", xlim = c(-.1, .1), main = "")
hist(odd.boot, breaks = "Scott", xlim = c(-.1, .1), main = "")
par(opar)  # reset graphical parameters
P2.4 <- c(mean(even.boot),mean(odd.boot))
```

```{r}
df <- data.frame(Small=P2.1,Medium=P2.2,Large=P2.3,Extra_Large=P2.4,row.names=c("Even Boot","Odd Boot"))
df
```

> ANSWER: In general, the parity matters when it comes to medians because with an odd sample size there is an exact median while with an even number the median must be interpolated between two central idecies

**Problem 3:**  Import the data set `Bangladesh`. In addition to arsenic concentrations for 271 wells, the data set contains cobalt and chlorine concentrations.

  * Conduct EDA on the chlorine concentrations and describe the salient features.

> ANSWER: 

  * The `Chlorine` variable has some missing values. The following code will remove these entries:

> `chlorine <- subset(Bangladesh, select = Chlorine, subset = !is.na(Chlorine), drop = TRUE)`

  * Bootstrap the mean.
    
> ANSWER: 

  * Find and interpret the 92% bootstrap percentile confidence interval.


> ANSWER:  

  * What is the bootstrap estimate of the bias?  What percent of the bootstrap standard error does it represent?
  
>  ANSWER:  


**Problem 4:**  The data set `FishMercury` contains mercury levels (parts per million) for 30 fish caught in lakes in Minnesota.

  * Create a histogram and a horizontal boxplot of the data. Place both graphs in the same graphical device.  Use the same scale on the $x$-axis for both graphs. What do you observe?

> ANSWER:  
  
  * Bootstrap the mean and record the bootstrap standard error and the 95% bootstrap percentile interval.

> ANSWER: 

  * Remove the outlier and bootstrap the mean of the remaining data.  Record the bootstrap standard error and the 95% bootstrap percentile interval.

> ANSWER: 

  * What effect did removing the outlier have on the bootstrap distribution, in particular, the standard error?
  
> ANSWER: 

**Problem 5:**  Do chocolate and vanilla ice creams have the same number of calories? The data set `IceCream` contains calorie information for a sample of brands of chocolate and vanilla ice cream. Use the bootstrap to determine whether or not there is a difference in the mean number of calories.  Specifically, use a 90% bootstrap percentile confidence interval for the parameter of interest to support your conclusions.

  * What is the parameter of interest?
  
> ANSWER: 

> ANSWER:

**Problem 6:**  Import the data set `FlightDelays` into `R`. Although the data are all on UA and AA flights flown in May in June of 2009, we will assume these represent a sample from a larger population of UA and AA flights flown under similar circumstances. We will consider the ratio of means of the flight delay lengths, $\mu_{UA}/\mu_{AA}$.

  * Create histograms, boxplots, and quantile-quantile plots for the flight delay times of UA and AA flights.  (Extra Credit if the graphs are done with ggplot2.)  Characterize the distribution of flight delay times for each carrier.  
  

> ANSWER: 
```{r}
### yay ggplot

```

  
  * Bootstrap the mean of flight delay times for each airline separately and describe the resulting bootstrap distributions.  Place the histograms and normal quantile-quantile plots of the bootstrapped quantities in the same graphical device.  That is, place all four graphs in the same device. (Hint use: `par(mfrow=c(2, 2))`) 
  

> ANSWER: 
  
  * Bootstrap the ratio of means. Provide plots of the bootstrap distribution and describe the distribution. 

> ANSWER: 

  * Find a 96% bootstrap percentile interval for the ratio of means. Interpret this interval making sure to write out the parameter to which the interval applies.


> ANSWER:

  * What is the bootstrap estimate of the bias? What fraction of the bootstrap standard error does it represent?
  
> ANSWER: 

**Problem 7:**  Import the data set ` Twins` into `R`.  In a 1990 study by Suddath et al., reported in Ramsey and Schaeffer, researchers used magnetic resonance imaging to measure the volume of various regions of the brain for a sample of 15 monozygotic twins, where one twin was affected with schizophrenia and the other was unaffected. The twins were from North America and comprised eight male pairs, and seven female pairs ranging in age from 25 to 44 at the time of the study. The sizes in volume ($\text{cm}^3$) of the hippocampus are in the file called `Twins`. 

  * Should the data be analyzed as matched pairs or be treated as if there were two independent samples?
  
> ANSWER: 
  
  * Use appropriate graphics and summary statistics to describe the difference in brain volume for affected and unaffected twins.
  
> ANSWER: 

  * Use the appropriate randomization test to ascertain if the difference in brain volume described in the previous bullet is the result of schizophrenia or if it could be explained as a chance difference. Report your _p_-value and summarize your conclusion.

> ANSWER: